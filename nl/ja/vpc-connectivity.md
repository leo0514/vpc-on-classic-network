---

copyright:
  years: 2018, 2019
lastupdated: "2019-05-14"

keywords: capabilities, use cases, subnets, VPN, connections, reserved, IP, IPv4, floating

subcollection: vpc-on-classic-network

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}
{:DomainName: data-hd-keyref="DomainName"}

# VPC でのネットワーキングについて
{: #about-networking-for-vpc}

この資料では、{{site.data.keyword.cloud}} VPC におけるサブネット、浮動 IP アドレス、および VPN 接続のユース・ケースと機能を説明する概念を紹介します。

![IBM VPC 接続性およびセキュリティー](images/vpc-connectivity-and-security.svg "IBM VPC 接続性およびセキュリティー")

この図の説明を次に示します。

* 各サブネットは、オプションのパブリック・ゲートウェイ (PGW) 経由でパブリック・インターネットに接続できます。
* インターネットと VSI の間で双方向に通信できるように、VSI に浮動 IP アドレス (FIP) を割り当てることができます。
* IBM Cloud VPC のサブネットはプライベート接続に使用されます。サブネットはプライベート・リンク経由で相互に通信できます。 経路をセットアップする必要はありません。
* 詳細については、[VPC インフラストラクチャーについて](/docs/vpc-on-classic?topic=vpc-on-classic-about)を参照してください。

## 用語
{: #terminology}

この[用語集](/docs/vpc-on-classic?topic=vpc-on-classic-vpc-glossary)には、この資料で使用されている IBM Cloud VPC の用語の定義と説明が記載されています。

## VPC のサブネットの特性
{: #characteristics-of-subnets-in-the vpc}

サブネットには、指定された IP アドレス範囲 (CIDR ブロック) があります。 サブネットは 1 つのゾーンにバインドされ、複数のゾーンまたはリージョンをまたぐことはできません。 ただし、仮想プライベート・クラウドの抽象的なゾーン全体を 1 つのサブネットにすることができます。 同じ IBM Cloud VPC 内の各サブネットは相互に接続されます。

### ゾーン
{: #zones}

ゾーンは、耐障害性の向上および遅延時間の短縮を実現するために設計された抽象的な概念です。 ゾーンには次の特性があります。

 * 各ゾーンは独立した障害ドメインであり、1 つのリージョン内の 2 つのゾーンで同時に障害が発生する可能性は極めてまれです
 * 1 つのリージョン内のゾーン間のトラフィックの遅延時間は 2 ミリ秒未満です

### 予約済み IP アドレス
{: #reserved-ip-addresses}

仮想プライベート・クラウドの運用時に、IBM が使用するために特定の IP アドレスが予約されています。 予約済みアドレスを次に示します (これらの IP アドレスは、サブネットの CIDR 範囲が 10.10.10.0/24 であることを前提としています)。

  * CIDR 範囲内の 1 番目のアドレス (10.10.10.0): ネットワーク・アドレス
  * CIDR 範囲内の 2 番目のアドレス (10.10.10.1): ゲートウェイ・アドレス
  * CIDR 範囲内の 3 番目のアドレス (10.10.10.2): IBM により予約済み
  * CIDR 範囲内の 4 番目のアドレス (10.10.10.3): IBM により将来の使用のために予約済み
  * CIDR 範囲内の最後のアドレス (10.10.10.255): ネットワーク・ブロードキャスト・アドレス

### サブネットの外部接続用にパブリック・ゲートウェイを使用する
{: #use-a-public-gateway-for-external-connectivity-of-a-subnet}

**パブリック・ゲートウェイ (PGW)** を使用すると、サブネット (そのサブネットに接続されたすべての VSI を含む) からインターネットに接続できるようになります。 デフォルトでは、サブネットはプライベート・アドレスになることに注意してください。ただし、オプションで PGW を作成し、その PGW にサブネットを接続することができます。 サブネットを PGW に接続すると、そのサブネットに属するすべての VSI はインターネットに接続できます。

PGW は_多対 1 の NAT_ を使用します。これは、プライベート・アドレスを持つ数千もの VSI が 1 つのパブリック IP アドレスを使用してパブリック・インターネットと通信することを意味します。PGW を使用するだけでは、インターネットはこれらのインスタンスと接続を開始できません。 PGW とサブネットの間の接続と切り離しには、API を使用します。

ゲートウェイ・サービスの範囲を次の図にまとめます。

![ゲートウェイ・サービス](images/scope-of-gateway-services.png)

### VSI の外部接続用に浮動 IP アドレスを使用する
{: #use-a-floating-ip-address-for-external-connectivity-of-a-vsi}

**浮動 IP アドレス**は、システムによって提供される IP アドレスであり、パブリック・インターネットからアクセス可能なアドレスです。

IBM から提供される使用可能な浮動 IP アドレスのプールに含まれている浮動 IP アドレスを予約できます。また、同一仮想プライベート・クラウド内の任意のインスタンスに、そのインスタンスの vNIC を使用して、浮動 IP アドレスを関連付けたり、関連付けを解除したりできます。 浮動 IP アドレスは、ロード・バランサーや VPN ゲートウェイなど、さまざまなタイプの仮想サーバー・インスタンス (VSI) に関連付けることができます。

浮動 IP アドレスを複数のインターフェースに関連付けることはできません。個別の浮動 IP に関連付けるインターフェースを VSI で指定する必要があります。 このインターフェースにはプライベート IP アドレスも設定されます。 バックエンド・システムは、そのインターフェースの浮動 IP とプライベート IP の間で _1 対 1 の NAT_ 操作を実行します。 浮動 IP が解放されるのは、解放アクションを明示的に要求した場合に限られます。

**注:**
* **浮動 IP アドレスを VSI に関連付けると、前述の PGW の多対 1 の NAT からその VSI が削除されます。**
* **現時点では、浮動 IP では IPv4 アドレスだけがサポートされます。**
* **ユーザー持ち込みのパブリック IP アドレスを浮動 IP として使用することはできません。**

NAT 操作について詳しくは、[インターネット RFC 関連資料 ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](http://www.faqs.org/rfcs/rfc1631.html){: new_window} を参照してください。

### セキュアな外部接続のために VPN を使用する。
{: #use-a-vpn-for-secure-external-connectivity}

ユーザーがインターネットから IBM Cloud VPC に安全に接続できるように、仮想プライベート・ネットワーク (VPN) サービスが用意されています。 ステップバイステップの説明については、[IBM Console UI ガイド](/docs/vpc-on-classic?topic=vpc-on-classic-creating-a-vpc-using-the-ibm-cloud-console)を参照してください。

**VPN の機能**
  * データ転送を処理するために VPN サービス (サイト間 IPSEC VPN) の CRUD (作成、読み取り、更新、削除) を行う機能。
  * VPN サービスとお客様の IBM Cloud VPC または仮想ネットワークを関連付ける機能。
  * 静的定義または動的ルーティングによってお客様のサイト内サブネットを識別する機能。
  * SHA256、AES、3DES、IKEv2 などのセキュア暗号のサポート。
  * 組み込みサービスの信頼性。
  * VPN 接続の正常性のモニター。
  * イニシエーター・モードとレスポンダー・モードのサポート。つまり、トンネルのどちら側からでもトラフィックを開始できます。
